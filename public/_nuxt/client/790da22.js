(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{1067:function(e,t,r){"use strict";r.r(t);var o=r(165),n=r(241),c=r(76),d=r(997),l=r(562),f=r(512),m=r(232),x=r(202),v=r(167),h=r(238),U=r(7),C=r(235),A=r(561),y=r(515),B=(r(38),r(60),r(49),r(34),r(56),r(48),r(28),r(10),r(63),r(67),r(51),r(18)),k=(r(52),r(36),r(210),r(209),r(6),r(111),r(773));function _(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,c=!0,d=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){d=!0,n=e},f:function(){try{c||null==r.return||r.return()}finally{if(d)throw n}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}var N=r(110).b.firestore(),I={name:"",layout:"moderador",middleware:"esModerador",data:function(){return{uidCurso:this.$route.params.uidCurso,datosCurso:null,uidAuxiliares:[],datosAuxiliares:[],tipoBusquedaCorreo:!0,tipoBusquedaNombreUsuario:!1,tipoBusquedaUID:!1,codigo:"buscaUnCorreo@gmail.com",buscando:!1,datosUsuario:null,noExisteElUsuario:!1,actualizandoAuxiliares:!1}},components:{VisualizadorDatosUsuario:k.default},methods:{vaciar:function(){this.buscando=!1,this.datosUsuario=null,this.noExisteElUsuario=!1},buscar:function(){var e=this;return Object(B.a)(regeneratorRuntime.mark((function t(){var r,o,n,data,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.vaciar(),e.buscando=!0,r="",e.tipoBusquedaCorreo?r="correo":e.tipoBusquedaNombreUsuario?r="nombreUsuario":e.tipoBusquedaUID&&(r="uid"),!(o=e.$firebase.auth().currentUser)){t.next=12;break}return t.next=9,o.getIdToken();case 9:t.t0=t.sent,t.next=13;break;case 12:t.t0="";case 13:return o=t.t0,t.next=16,e.$store.dispatch("modules/usuarios/setTOKEN",o);case 16:return n={headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}},t.next=19,e.$axios.$get("/serviceUsuario/moderador/obtenerUsuario/".concat(r,"/").concat(e.codigo),n);case 19:if(200===(data=t.sent).estado){t.next=24;break}return e.noExisteElUsuario=!0,e.buscando=!1,t.abrupt("return");case 24:if("estudiante"===data.resultado.firestore.rol){t.next=31;break}return t.next=27,N.collection("Miembros").doc(data.resultado.firestore.uid).get();case 27:c=t.sent,e.datosUsuario=Object.assign(data.resultado,{miembro:c.data()}),t.next=32;break;case 31:e.datosUsuario=data.resultado;case 32:t.next=39;break;case 34:return t.prev=34,t.t1=t.catch(0),t.next=38,e.$store.dispatch("modules/sistema/errorHandler",t.t1);case 38:t.sent;case 39:return t.prev=39,e.buscando=!1,t.finish(39);case 42:case"end":return t.stop()}}),t,null,[[0,34,39,42]])})))()},quitarAuxiliar:function(e){var t=this;return Object(B.a)(regeneratorRuntime.mark((function r(){var o,n,c,d,l,f;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=JSON.parse(JSON.stringify(t.datosCurso.auxiliares)),n=JSON.parse(JSON.stringify(t.uidAuxiliares)),c=JSON.parse(JSON.stringify(t.datosAuxiliares)),d=o.findIndex((function(t){return t===e})),o.splice(d,1),t.datosCurso.auxiliares=o,l=n.findIndex((function(t){return t===e})),n.splice(l,1),t.uidAuxiliares=n,f=c.findIndex((function(t){return t.uid===e})),c.splice(f,1),t.datosAuxiliares=c,r.next=14,t.actualizarAuxiliares();case 14:case"end":return r.stop()}}),r)})))()},agregarAuxiliar:function(e){var t=this;return Object(B.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.datosCurso.auxiliares.push(e),t.uidAuxiliares.push(e),t.datosAuxiliares.push({uid:e,firestore:t.datosUsuario.firestore,auth:t.datosUsuario.auth,estado:"listo"}),r.next=5,t.actualizarAuxiliares();case 5:case"end":return r.stop()}}),r)})))()},actualizarAuxiliares:function(){var e=this;return Object(B.a)(regeneratorRuntime.mark((function t(){var r,body,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.actualizandoAuxiliares=!0,!(r=e.$firebase.auth().currentUser)){t.next=8;break}return t.next=5,r.getIdToken();case 5:t.t0=t.sent,t.next=9;break;case 8:t.t0="";case 9:return r=t.t0,t.next=12,e.$store.dispatch("modules/usuarios/setTOKEN",r);case 12:return body={auxiliares:e.uidAuxiliares},o={headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)}},t.next=16,e.$axios.$put("/serviceCursoBorrador/moderador/actualizarAuxiliares/".concat(e.uidCurso),body,o);case 16:e.actualizandoAuxiliares=!1;case 17:case"end":return t.stop()}}),t)})))()}},watch:{tipoBusquedaCorreo:function(e,t){this.tipoBusquedaCorreo&&(this.codigo="buscaUnCorreo@gmail.com",this.tipoBusquedaNombreUsuario=!1,this.tipoBusquedaUID=!1)},tipoBusquedaNombreUsuario:function(e,t){this.tipoBusquedaNombreUsuario&&(this.codigo="",this.tipoBusquedaCorreo=!1,this.tipoBusquedaUID=!1)},tipoBusquedaUID:function(e,t){this.tipoBusquedaUID&&(this.codigo="",this.tipoBusquedaNombreUsuario=!1,this.tipoBusquedaCorreo=!1)}},created:function(){var e=this;return Object(B.a)(regeneratorRuntime.mark((function t(){var r,o,n,c,d,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N.collection("CursosPublicado").doc(e.uidCurso).get();case 2:if((r=t.sent).exists){t.next=6;break}return e.$router.push("/moderador/cursos/borradores"),t.abrupt("return");case 6:e.datosCurso=r.data(),e.uidAuxiliares=r.data().auxiliares,o=_(e.uidAuxiliares);try{for(o.s();!(n=o.n()).done;)c=n.value,e.datosAuxiliares.push({uid:c,firestore:null,auth:null,estado:"cargando"})}catch(e){o.e(e)}finally{o.f()}d=JSON.parse(JSON.stringify(e.datosAuxiliares)),l=new Promise((function(t,r){for(var o=function(i){var r=e.uidAuxiliares[i];N.collection("Usuarios").doc(r).get().then(function(){var o=Object(B.a)(regeneratorRuntime.mark((function o(n){var c,l;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e.$axios.$get("/serviceUsuario/obtenerAuthentication/uid/".concat(n.id));case 2:c=o.sent,l=c.resultado,d[i]={uid:r,firestore:n.data(),auth:l,estado:"listo"},d.find((function(e){return"cargando"===e.estado}))||t(d);case 7:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}())},i=0;i<e.uidAuxiliares.length;i++)o(i)})),l.then((function(t){e.datosAuxiliares=t}));case 13:case"end":return t.stop()}}),t)})))()}},O=I,z=r(32),component=Object(z.a)(O,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t(A.a,[t(l.a,{attrs:{cols:"12",md:"8"}},[t("div",{staticClass:"mt-3"},[t(d.a,{staticClass:"mr-5",staticStyle:{display:"inline-block"},attrs:{label:"Correo",color:"#683bce","hide-details":""},model:{value:e.tipoBusquedaCorreo,callback:function(t){e.tipoBusquedaCorreo=t},expression:"tipoBusquedaCorreo"}}),e._v(" "),t(d.a,{staticClass:"mr-5",staticStyle:{display:"inline-block"},attrs:{label:"Nombre de usuario",color:"#683bce","hide-details":""},model:{value:e.tipoBusquedaNombreUsuario,callback:function(t){e.tipoBusquedaNombreUsuario=t},expression:"tipoBusquedaNombreUsuario"}}),e._v(" "),t(d.a,{staticClass:"mr-5",staticStyle:{display:"inline-block"},attrs:{label:"UID",color:"#683bce","hide-details":""},model:{value:e.tipoBusquedaUID,callback:function(t){e.tipoBusquedaUID=t},expression:"tipoBusquedaUID"}}),e._v(" "),t("div",{staticClass:"mt-3"},[e.tipoBusquedaCorreo?t(y.a,{attrs:{counter:100,label:"Correo del usuario"},model:{value:e.codigo,callback:function(t){e.codigo=t},expression:"codigo"}}):e.tipoBusquedaNombreUsuario?t(y.a,{attrs:{counter:20,label:"Nombre de usuario"},model:{value:e.codigo,callback:function(t){e.codigo=t},expression:"codigo"}}):e.tipoBusquedaUID?t(y.a,{attrs:{label:"UID del usuario"},model:{value:e.codigo,callback:function(t){e.codigo=t},expression:"codigo"}}):e._e(),e._v(" "),t(o.a,{staticClass:"mt-2",attrs:{outlined:"",rounded:"",text:"",color:"#683bce"},on:{click:e.buscar}},[e._v("\n                        Buscar\n                    ")])],1)],1),e._v(" "),t(f.a,{staticClass:"my-7"}),e._v(" "),e.buscando?t("div",[e._v("\n                Buscando..\n                "),t(C.a,{attrs:{indeterminate:"",color:"#683bce"}})],1):t("div",[e.datosUsuario?t("div",{},[e.datosCurso.instructor!==e.datosUsuario.firestore.uid&&e.datosUsuario.miembro.funciones.includes("instructor-auxiliar")?t("div",{staticClass:"text-center"},[e.uidAuxiliares.includes(e.datosUsuario.firestore.uid)?t("div",{staticClass:"mb-7"},[t(o.a,{attrs:{disabled:e.actualizandoAuxiliares,outlined:"",rounded:"",text:"",color:"#683bce"},on:{click:function(t){return e.quitarAuxiliar(e.datosUsuario.firestore.uid)}}},[t(m.a,{attrs:{left:""}},[e._v("\n                                    mdi-minus\n                                ")]),e._v("\n                                Quitar de auxiliares\n                            ")],1)],1):t("div",{staticClass:"mb-7"},[t(o.a,{attrs:{disabled:e.actualizandoAuxiliares,outlined:"",rounded:"",text:"",color:"#683bce"},on:{click:function(t){return e.agregarAuxiliar(e.datosUsuario.firestore.uid)}}},[t(m.a,{attrs:{left:""}},[e._v("\n                                    mdi-plus\n                                ")]),e._v("\n                                Agregar auxiliar\n                            ")],1)],1)]):e._e(),e._v(" "),t("VisualizadorDatosUsuario",{attrs:{firestore:e.datosUsuario.firestore,auth:e.datosUsuario.auth,miembro:e.datosUsuario.miembro}})],1):e.noExisteElUsuario?t("div",[e._v("\n                    No existe el usuario :(\n                ")]):t("div",[e._v("\n                    Busca un usuario :)\n                ")])])],1),e._v(" "),t(l.a,{attrs:{cols:"12",md:"4"}},e._l(e.datosAuxiliares,(function(r,d){return t(n.a,{key:d,staticClass:"mb-7",attrs:{loading:"cargando"===r.estado,outlined:""}},[t("template",{slot:"progress"},[t(C.a,{attrs:{color:"deep-purple",height:"10",indeterminate:""}})],1),e._v(" "),t(v.a,{attrs:{"three-line":""}},[t(U.a,["cargando"===r.estado?t(U.c,{staticClass:"text-h5 mb-1"},[e._v("\n                            Cargando...\n                        ")]):t(U.c,{staticClass:"text-h5 mb-1"},[e._v("\n                            "+e._s(r.auth.displayName)+"\n                        ")]),e._v(" "),"cargando"!==r.estado?t(U.b,[e._v("\n                            "+e._s(r.firestore.nombreUsuario)+"\n                        ")]):e._e()],1),e._v(" "),"cargando"===r.estado?t(h.a,{attrs:{tile:"",size:"80",color:"grey"}}):t(h.a,{attrs:{tile:"",size:"80",color:"grey"}},[t(x.a,{attrs:{src:r.auth.photoURL}})],1)],1),e._v(" "),t(c.a,[t("div",{staticClass:"py-2"},[t(o.a,{attrs:{disabled:e.actualizandoAuxiliares||"cargando"===r.estado,outlined:"",rounded:"",text:"",color:"#683bce"},on:{click:function(t){return e.quitarAuxiliar(r.uid)}}},[t(m.a,{attrs:{left:""}},[e._v("\n                                mdi-minus\n                            ")]),e._v("\n                            Quitar de auxiliares\n                        ")],1)],1)])],2)})),1)],1)],1)}),[],!1,null,"1e681e7c",null);t.default=component.exports}}]);