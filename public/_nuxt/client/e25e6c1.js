(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{1060:function(e,t,o){"use strict";o.r(t);var n=o(165),c=o(999),r=o(564),d=o(1021),l=o(514),h=o(668),f=o(563),m=o(1016),v=o(517),P=o(18),_=(o(52),o(24),o(351),o(38),o(60),o(580)),x=o(581),j=o(110),D={layout:"miembro",middleware:"esInstructor",mixins:[_.validationMixin],validations:{precio:{required:x.required,numeric:x.numeric,minValue:Object(x.minValue)(0),maxValue:Object(x.maxValue)(2700)},descuento:{porcentaje:{required:x.required,numeric:x.numeric,minValue:Object(x.minValue)(3),maxValue:Object(x.maxValue)(100)},fechaInicio:{},fechaFin:{}}},data:function(){return{uidCurso:this.$route.params.uidCurso,precio:0,descuento:{porcentaje:3,fechaInicio:0,fechaFin:0,fechas:[]},conDescuento:!1,reglas:["1JP = $0.0798","El precio se maneja en FiiPoints (FP).","El precio de un curso debe estar en un rango de 0JP a 2700JP.","Para aplicar descuentos al curso, el curso debe costar mínimo 250JP.","El % de descuento un curso debe estar en un rango de 3% a 100%.","Son requeridas las fechas desde/hasta de descuento para un curso en descuento."],actualizandoPrecio:!1}},methods:{getDescuento:function(e,t){var o=e-e*(t.porcentaje/100);return Number(o.toFixed())},JP_to_dolar:function(e){return(.0798*e).toFixed(2)},JP_to_dolar_descuento:function(e,t){var o=.0798*e;return(o-o*(t.porcentaje/100)).toFixed(2)},middleware:function(){return this.$v.$touch(),{precio:this.precio,descuento:this.conDescuento?{porcentaje:this.descuento.porcentaje/100,fechaInicio:this.descuento.fechaInicio,fechaFin:this.descuento.fechaFin}:null}},actualizarPrecio:function(){var e=this;return Object(P.a)(regeneratorRuntime.mark((function t(){var o,n,body,c,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,o=e.middleware(),e.actualizandoPrecio=!0,!(n=e.$firebase.auth().currentUser)){t.next=10;break}return t.next=7,n.getIdToken();case 7:t.t0=t.sent,t.next=11;break;case 10:t.t0="";case 11:return n=t.t0,t.next=14,e.$store.dispatch("modules/usuarios/setTOKEN",n);case 14:return body={datosPrecio:o},c={headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}},r=e.uidCurso,t.next=19,e.$axios.$put("/serviceCursoBorrador/miembro/actualizar-precio/".concat(r),body,c);case 19:t.next=27;break;case 21:return t.prev=21,t.t1=t.catch(0),console.log("error",t.t1),t.next=26,e.$store.dispatch("modules/sistema/errorHandler",t.t1);case 26:t.sent;case 27:return t.prev=27,e.actualizandoPrecio=!1,t.finish(27);case 30:case"end":return t.stop()}}),t,null,[[0,21,27,30]])})))()},allowedDates:function(e){var t=new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),o=new Date(e).getTime();return new Date(t).getTime()<=o},sumarDias:function(e,t){return e.setDate(e.getDate()+t),e}},watch:{precio:function(e,t){this.precio<250&&(this.conDescuento=!1)},conDescuento:function(e,t){this.conDescuento||(this.descuento={porcentaje:3,fechaInicio:0,fechaFin:0,fechas:[]})},"descuento.fechas":function(e,t){if(2===this.descuento.fechas.length){if(new Date(this.descuento.fechas[0]).getTime()>new Date(this.descuento.fechas[1]).getTime()){var o=this.descuento.fechas[0];this.descuento.fechas[0]=this.descuento.fechas[1],this.descuento.fechas[1]=o}this.descuento.fechaInicio=new Date("".concat(this.descuento.fechas[0],"T00:00:00Z")).getTime(),this.descuento.fechaFin=new Date("".concat(this.descuento.fechas[1],"T23:59:59Z")).getTime()}}},computed:{computedPrecio:{get:function(){return this.precio},set:function(e){var t=e.includes(",");return this.precio=t?0:Number(parseInt(e)),Number(parseInt(e))}},errorsPrecio:function(){var e=[];return this.$v.precio.$dirty?(!this.$v.precio.required&&e.push("El precio debe existir."),!this.$v.precio.numeric&&e.push("El precio debe ser numérico."),!this.$v.precio.minValue&&e.push("El mínimo precio es 0JP."),!this.$v.precio.maxValue&&e.push("El máximo precio es 2700JP."),e):e},errorsPorcetajeDescuento:function(){var e=[];return this.$v.descuento.porcentaje.$dirty?(!this.$v.descuento.porcentaje.required&&e.push("El precio debe existir."),!this.$v.descuento.porcentaje.numeric&&e.push("El descuento debe ser numérico."),!this.$v.descuento.porcentaje.minValue&&e.push("El mínimo descuento es 3%."),!this.$v.descuento.porcentaje.maxValue&&e.push("El máximo descuento es 100%."),e):e}},created:function(){var e=this;return Object(P.a)(regeneratorRuntime.mark((function t(){var o,n,c,r,d,l,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=j.b.firestore(),t.next=3,o.collection("CursosPublicado").doc(e.uidCurso).get();case 3:if(!(n=t.sent).exists){t.next=10;break}e.precio=n.data().datosPrecio.precio,n.data().datosPrecio.descuento?(c={inicio:1e3*n.data().datosPrecio.descuento.fechaInicio.seconds,fin:1e3*n.data().datosPrecio.descuento.fechaFin.seconds},r={inicio:new Date(c.inicio-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),fin:new Date(c.fin-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10)},e.descuento={porcentaje:100*n.data().datosPrecio.descuento.porcentaje,fechaInicio:c.inicio,fechaFin:c.fin,fechas:[r.inicio,r.fin]}):e.descuento={porcentaje:3,fechaInicio:0,fechaFin:0,fechas:[]},e.conDescuento=!!n.data().datosPrecio.descuento,t.next=14;break;case 10:return t.next=12,o.collection("CursosBorrador").doc(e.uidCurso).get();case 12:(d=t.sent).exists?(e.precio=d.data().datosPrecio.precio,d.data().datosPrecio.descuento?(l={inicio:1e3*d.data().datosPrecio.descuento.fechaInicio.seconds,fin:1e3*d.data().datosPrecio.descuento.fechaFin.seconds},h={inicio:new Date(l.inicio-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),fin:new Date(l.fin-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10)},e.descuento={porcentaje:100*d.data().datosPrecio.descuento.porcentaje,fechaInicio:l.inicio,fechaFin:l.fin,fechas:[h.inicio,h.fin]}):e.descuento={porcentaje:3,fechaInicio:0,fechaFin:0,fechas:[]},e.conDescuento=!!d.data().datosPrecio.descuento):e.$router.push("/miembro/curso-borrador/".concat(e.uidCurso));case 14:case"end":return t.stop()}}),t)})))()}},$=(o(937),o(32)),component=Object($.a)(D,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t(f.a,{staticStyle:{"margin-top":"-17px"},attrs:{"no-gutters":""}},[t(r.a,{attrs:{cols:"12",md:"8"}},[t(h.a,{staticClass:"contenedor_izquierdo",attrs:{disabled:e.actualizandoPrecio}},[t("h3",{staticClass:"mb-5"},[e._v(" \n                    El curso es de tipo: \n                    "+e._s(0!==e.precio?"Pago":"Gratis")+" \n                ")]),e._v(" "),t("div",{staticClass:"mb-3"},[t(f.a,[t(r.a,{attrs:{cols:"9"}},[t(v.a,{staticClass:"mt-0 pt-0",attrs:{type:"number",label:"FiiPoints:",placeholder:"FiiPoints","error-messages":e.errorsPrecio,color:"#683bce",max:"2700",min:"0"},on:{input:function(t){return e.$v.precio.$touch()},blur:function(t){return e.$v.precio.$touch()}},model:{value:e.computedPrecio,callback:function(t){e.computedPrecio=t},expression:"computedPrecio"}})],1),e._v(" "),t(r.a,{attrs:{cols:"3"}},[e._v("\n                            $"+e._s(e.JP_to_dolar(e.precio))+"\n                        ")])],1)],1),e._v(" "),t(c.a,{staticStyle:{"margin-top":"0"},attrs:{disabled:!e.precio||e.precio<250,color:"#683bce",label:"¿Quieres agregar descuento?"},model:{value:e.conDescuento,callback:function(t){e.conDescuento=t},expression:"conDescuento"}}),e._v(" "),e.conDescuento&&e.precio&&e.precio>=10?t("div",{staticClass:"contenedor_descuento mt-3"},[t(m.a,{staticClass:"mb-3",attrs:{"error-messages":e.errorsPorcetajeDescuento,label:"Porcentaje:",color:"#683bce","thumb-color":"#683bce",max:"100",min:"3"},on:{input:function(t){return e.$v.descuento.porcentaje.$touch()},blur:function(t){return e.$v.descuento.porcentaje.$touch()}},scopedSlots:e._u([{key:"append",fn:function(){return[t(v.a,{staticClass:"mt-0 pt-0",staticStyle:{width:"70px"},attrs:{"hide-details":"","single-line":"",type:"number",max:"100",min:"3"},model:{value:e.descuento.porcentaje,callback:function(t){e.$set(e.descuento,"porcentaje",t)},expression:"descuento.porcentaje"}})]},proxy:!0}],null,!1,2559067902),model:{value:e.descuento.porcentaje,callback:function(t){e.$set(e.descuento,"porcentaje",t)},expression:"descuento.porcentaje"}}),e._v(" "),t("div",{staticClass:"mb-5"},[t(d.a,{attrs:{color:"#683bce","no-title":"",scrollable:"","full-width":"",range:"","allowed-dates":e.allowedDates,disabled:e.actualizandoPrecio},model:{value:e.descuento.fechas,callback:function(t){e.$set(e.descuento,"fechas",t)},expression:"descuento.fechas"}})],1),e._v(" "),t("div",{staticClass:"mb-3"},[t("p",[t("b",[e._v("Precio con descuento:")]),e._v(" \n                            "+e._s(e.getDescuento(e.precio,e.descuento))+" FP\n                        ")]),e._v(" "),t("p",[t("b",[e._v("Precio con descuento:")]),e._v(" \n                            $"+e._s(e.JP_to_dolar_descuento(e.precio,e.descuento))+"\n                        ")])])],1):e._e(),e._v(" "),t(l.a,{staticClass:"mb-7"}),e._v(" "),t(n.a,{attrs:{loading:e.actualizandoPrecio,disabled:e.$v.$anyError||e.conDescuento&&2!==e.descuento.fechas.length,outlined:"",color:"#683bce"},on:{click:e.actualizarPrecio}},[e._v("\n                    Actualizar precio\n                ")])],1)],1),e._v(" "),t(r.a,{attrs:{cols:"12",md:"4"}},[t("div",{staticClass:"contenedor_derecho"},[t("h3",[e._v("Reglas")]),e._v(" "),t(l.a,{staticClass:"mb-5"}),e._v(" "),t("ul",e._l(e.reglas,(function(o,n){return t("li",{key:n},[e._v("\n                        "+e._s(o)+"\n                    ")])})),0)],1)])],1)],1)}),[],!1,null,"cb5f4a24",null);t.default=component.exports},744:function(e,t,o){},937:function(e,t,o){"use strict";o(744)}}]);